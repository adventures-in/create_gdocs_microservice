import 'dart:convert';

Map<String, dynamic> decodeFromBase64(String base64String) =>
    jsonDecode(utf8.decode(base64.decode(base64.normalize(base64String))));

// Verifying an id token as described in:
// https://firebase.google.com/docs/auth/admin/verify-id-tokens#verify_id_tokens_using_a_third-party_jwt_library
// involves checking the kid againt the public keys at https://www.googleapis.com/robot/v1/metadata/x509/securetoken@system.gserviceaccount.com
//
// I'm not sure if the keys could change so we should find out and if so will
// probably need to retrieve the keys each time (or preferably cache them somewhere)
final publicKeysString = r'''
{
  "2c8e2b296c6f3284ec30b8865d7293e627fa2b8f": "-----BEGIN CERTIFICATE-----\nMIIDHDCCAgSgAwIBAgIIAOZHudlzidwwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE\nAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMjEw\nNDE0MDkyMDIwWhcNMjEwNDMwMjEzNTIwWjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl\nbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBALfJnTPzyFu6w7wGb6ug5a68Mqhu0zn18dK+bvqXzUF25lb3\na5L3gko6B4WVFJ9jKQcA/Nx0feiDOnZAczHSasMhSt4b2eLWM1cVxsjOleLVns7I\n9i6OQqcA05vZqIbae5Acy/nObv466ySBd7Mm4kbUqaQL2mnYtcQy14OCYwRMh14g\n1v34Ki0pF/qdPrLDQ9nhvtFfzIznwLS+uQ7IJGzEK+nnlMof6KwzUYEERzIqvAzj\nGSEFz1LNGJF+4XTvIH58sA5YOnyAHq8Qir90BMjTvVNM5KGSS04QpbcR1Qzqh/LY\njt8ahGt2Xv1RnS0UGAxlzXc75AWp2AfcD/kWrBsCAwEAAaM4MDYwDAYDVR0TAQH/\nBAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ\nKoZIhvcNAQEFBQADggEBALEYVxLdmHbNp0orEzVbISU6f+o0DGvY8ltNZFHLRTnM\n32aptquKSOxYjDIxgxVcPN4OhH63AQbjdCxwilBGI1yJMpZrlNhywmINfhrwZEsa\nnEwBy/hnSwiX6KqkB3R5hEgGaajj0y654Jk6BuWOTI/aCtg6TH7dBO4ftcpBI3k3\no2ob54grfeugH/zRZwIAO/ZnCwXqX4EL9tJwmKFkJYD1aYMiR85XvCp9uOloNqy7\ncerHBJqz5F2qVqbJzdov3aWK3F9ogGNC1Y59a+RQJy5oBBqK4uG6TdwgtJZ5X1Ua\ntW1IJG1WuL8aziJE6xOdBb2D/9XhjclTaQ2PBEy1OuU=\n-----END CERTIFICATE-----\n",
  "1de8067a8298a4e3344b4dbded25f2fb4f40f3ce": "-----BEGIN CERTIFICATE-----\nMIIDHDCCAgSgAwIBAgIIcYRws2sTxJkwDQYJKoZIhvcNAQEFBQAwMTEvMC0GA1UE\nAxMmc2VjdXJldG9rZW4uc3lzdGVtLmdzZXJ2aWNlYWNjb3VudC5jb20wHhcNMjEw\nNDA2MDkyMDIwWhcNMjEwNDIyMjEzNTIwWjAxMS8wLQYDVQQDEyZzZWN1cmV0b2tl\nbi5zeXN0ZW0uZ3NlcnZpY2VhY2NvdW50LmNvbTCCASIwDQYJKoZIhvcNAQEBBQAD\nggEPADCCAQoCggEBAMoRTVdYXX6kW8oEplmvw5K2LnN3TSxdU2E4r3LKwY5wWEOI\nEJkgXq5mj+1D/AESJRE8eveVAKlR5/vBITPuJT99agjG/4vr9CNdEZjPc/TmqFmX\nwldeX/oE89LIoSuBKR/g3CRI17Z/0V/ZaeLwNlWz/A/L6+MEfEbgAIiSxXFkctXL\nTIWf3Ith24OTN8hVCgCaUWVLuY+FGprUnqQOqn1lpbtb1fgTSI/JAGXu6wsESyc3\nxslD2e4VyBQ1i+JoW3/VKydlODd3THydFRBHGPdJQkLH4ccDh2kQ4sWQ4vjupSsk\nBKMAvLqftpvVUo6LogEXNRmmI6sjluRlEvYk14kCAwEAAaM4MDYwDAYDVR0TAQH/\nBAIwADAOBgNVHQ8BAf8EBAMCB4AwFgYDVR0lAQH/BAwwCgYIKwYBBQUHAwIwDQYJ\nKoZIhvcNAQEFBQADggEBADFwIJVQERKO+x8Fx01ySjgSG6Rb81a17WQSCP2dlYmK\nFBvwaKK5tGVDt3RUnMgM5myEY11TX8yBF8UstxkqtMTzJh+K1hV6lC11YRqWzodq\nmJUBDuU39MYcRgoQn7szodBckdUGQlkTZti7xLApewkDpmR3Wx0KQBQpGt20Oaoq\nB2a5DVq4KsRirPtS71QvekM9Aars7pKrVNhxvXgkIMpiUAj3GJR5NAsJD0tsa9LM\nLvo31/AE1VKiRJ9ta21m15wO4CJyAiWvRbRiHDN9b9oXuJwUlzUgT0GFWHayt56e\nCYTU00dPphNMO1O07aqHq2O44/wPXYtQGDlHsg4sCeM=\n-----END CERTIFICATE-----\n"
}
''';
